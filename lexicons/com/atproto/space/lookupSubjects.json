{
    "lexicon": 1,
    "id": "com.atproto.space.lookupSubjects",
    "description": "List of subjects with the given permission over the resource. Requires auth, implemented by PDS.",
    "defs": {
        "main": {
            "type": "query",
            "description": "List of subjects with the given permission over the resource.",
            "parameters": {
                "type": "params",
                "properties": {
                    "resourceType": {
                        "type": "string",
                        "description": "The resource type [space,record,etc]"
                    },
                    "resource": {
                        "type": "string",
                        "description": "The object id to assign.",
                        "maxLength": 656
                    },
                    "permission": {
                        "type": "string",
                        "description": "possible values are defined in the spicedb schema and depend on context",
                        "maxLength": 32
                    },
                    "subjectType": {
                        "type": "string",
                        "description": "the subject type [user,group,etc]"
                    },
                    "subject": {
                        "type": "string",
                        "description": "the subject id to grant",
                        "maxLength": 640
                    },
                    "caveats": {
                        "type": "string",
                        "description": "nsids: { allowed: map<bool>, default bool, nsid string }"
                    },
                    "zookie": {
                        "type": "string",
                        "description": "The Zanzibar/SpiceDB consistency token, very similar in intent to CIDs in ATProto."
                    }
                },
                "required": [
                    "resourceType",
                    "resource",
                    "permission"
                ]
            },
            "output": {
                "encoding": "application/json",
                "schema": {
                    "type": "object",
                    "properties": {
                        "subjects": {
                            "type": "array",
                            "description": "List of all the subjects that have the given permission on the object.",
                            "items": {
                                "type": "string",
                                "description": "subject ids"
                            }
                        }
                    },
                    "required": [
                        "subjects"
                    ]
                }
            }
        }
    }
}
